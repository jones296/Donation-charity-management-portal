<div class="donation-page">

  <!-- HEADER -->
  <div class="page-header">
    <h2>Available Donation Requests</h2>
    <p>Choose a request and make a contribution</p>
  </div>

  <!-- LOADING -->
  <p *ngIf="loading" class="loading-text">
    Loading donation requests...
  </p>

  <!-- EMPTY STATE -->
  <p *ngIf="!loading && donations.length === 0" class="empty-text">
    No donation requests available right now.
  </p>

  <!-- DONATION LIST -->
  <div class="card-grid" *ngIf="!loading && donations.length > 0">

    <div class="donation-card" *ngFor="let d of donations">

      <!-- LEFT SECTION -->
      <div class="card-left">
        <h3>{{ d.donation_type }}</h3>

        <!-- TOTAL vs REMAINING (SAFE) -->
        <p>
          <strong>Quantity:</strong>
          {{ d.remaining_quantity ?? d.quantity_or_amount }}
          /
          {{ d.quantity_or_amount }}
        </p>

        <p>
          <strong>Location:</strong>
          {{ d.location }}
        </p>

        <p>
          <strong>Pickup Date:</strong>
          {{ d.pickup_date_time | date:'medium' }}
        </p>

        <!-- STATUS (SAFE) -->
        <span
          class="status"
          [class.pending]="(d.remaining_quantity ?? d.quantity_or_amount) > 0"
          [class.completed]="(d.remaining_quantity ?? d.quantity_or_amount) === 0"
        >
          {{
            (d.remaining_quantity ?? d.quantity_or_amount) > 0
              ? 'OPEN'
              : 'COMPLETED'
          }}
        </span>
      </div>

      <!-- RIGHT SECTION -->
      <div class="card-right">

        <!-- CAN STILL DONATE -->
        <button
          *ngIf="(d.remaining_quantity ?? d.quantity_or_amount) > 0"
          class="contribute-btn"
          (click)="contribute(d.id)"
        >
          Contribute
        </button>

        <!-- FULLY DONATED -->
        <span
          *ngIf="(d.remaining_quantity ?? d.quantity_or_amount) === 0"
          class="already-taken"
        >
          Fully Contributed
        </span>

      </div>

    </div>
  </div>

</div>