<div class="dashboard-page">

  <!-- HEADER -->
  <div class="dashboard-header">
    <div>
      <h2>NGO Dashboard</h2>
      <p class="subtitle">
        Manage donation requests and track pickup status
      </p>
    </div>

    <button class="logout-btn" (click)="logout()">Logout</button>
  </div>

  <!-- STATS -->
  <div class="stats-container">
    <div class="stat-card total">
      <h3>Total Requests</h3>
      <p>{{ stats.total }}</p>
    </div>

    <div class="stat-card pending">
      <h3>Pending / Confirmed</h3>
      <p>{{ stats.pending }}</p>
    </div>

    <div class="stat-card completed">
      <h3>Completed</h3>
      <p>{{ stats.completed }}</p>
    </div>
  </div>

  <!-- REQUEST LIST -->
  <div class="table-container">
    <h3 class="section-title">Donation Requests</h3>

    <table *ngIf="!loading && donations.length > 0">
      <thead>
        <tr>
          <th>Type</th>
          <th>Quantity</th>
          <th>Location</th>
          <th>Pickup Date</th>
          <th>Status</th>
          <th>Action</th>
        </tr>
      </thead>

      <tbody>
        <tr *ngFor="let d of donations">
          <td>{{ d.donation_type }}</td>
          <td>{{ d.quantity_or_amount }}</td>
          <td>{{ d.location }}</td>
          <td>{{ d.pickup_date_time | date: 'mediumDate' }}</td>

          <!-- STATUS -->
          <td>
            <span
              class="status-badge"
              [ngClass]="{
                pending: d.status === 'PENDING' || d.status === 'CONFIRMED',
                completed: d.status === 'COMPLETED'
              }"
            >
              {{ d.status }}
            </span>
          </td>

          <!-- ACTION -->
          <td>
            <!-- CONFIRMED → show button -->
            <button
              *ngIf="d.status === 'CONFIRMED'"
              class="complete-btn"
              (click)="markCompleted(d.id)"
            >
              Mark Completed
            </button>

            <!-- COMPLETED → show label -->
            <span
              *ngIf="d.status === 'COMPLETED'"
              class="completed-text"
            >
              ✔ Done
            </span>
          </td>
        </tr>
      </tbody>
    </table>

    <!-- EMPTY STATE -->
    <p class="empty" *ngIf="!loading && donations.length === 0">
      No donation requests created yet.
    </p>
  </div>

</div>